# Multi-Modal Sentiment Analysis

这是一个多模态情感分析项目，结合了文本和图像数据来进行情感分类。该项目使用了BERT模型进行文本编码，ResNet50进行图像特征提取，并通过一个简单的全连接层进行多模态特征融合。

## 项目结构

- `main.py`: 主代码文件，包含数据集定义、模型定义、训练和评估函数。
- `try.py`: 消融实验代码，与原实验结果进行对比。
- `train.txt`: 训练数据文件，包含文本和图像的标识符及其对应的情感标签。
- `test_without_label.txt`: 测试数据文件，包含文本和图像的标识符。
- `data文件夹`: 保存对应的文本和图像文件。
- `predictions.txt`: `main.py`的运行结果，对`test_without_label.txt`的`tag`列进行预测。

## 安装依赖

在运行项目之前，请确保安装了所有必要的Python包。可以通过以下命令安装：

```bash
pip install -r requirements.txt
```

## 使用方法

1. **准备数据**: 确保`train.txt`和`test_without_label.txt`文件在项目目录中，并且数据目录（data文件夹）中包含相应的文本和图像文件。

2. **运行代码**: 执行`main.py`和`try.py`文件进行训练和消融实验。

```bash
python main.py
python try.py
```

3. **查看结果**: 预测结果将保存在`predictions.txt`文件中。

## 模型架构

- **文本编码**: 使用`BertModel`从`transformers`库中进行文本特征提取。
- **图像编码**: 使用`ResNet50`从`torchvision`库中进行图像特征提取。
- **特征融合**: 将文本和图像特征连接后通过全连接层进行分类。

## 消融实验

代码中包含了消融实验的实现，可以分别评估仅使用文本或仅使用图像的模型性能。消融实验的结果可以帮助理解不同模态对模型性能的贡献。

## 注意事项

- 确保在运行代码时有可用的GPU以加速训练。
- 数据集的标签分布可能会影响模型的性能，建议在训练前检查数据集的平衡性。
- 如果模型在训练过程中出现过拟合，可以尝试调整超参数或使用数据增强技术。
- 本模型采用了每次对`train.txt`进行随机划分的形式，所以每次运行的结果可能不太一致，偶尔会出现过拟合情况。
- 在本github库中，鉴于data文件夹太大且包含文件过多，此处不做上传。

## 参考库

- `torch`: 用于构建和训练神经网络。
- `transformers`: 用于加载和使用BERT模型。
- `torchvision`: 用于加载和使用ResNet50模型。
- `Pillow`: 用于图像处理。
- `chardet`: 用于检测文本文件的编码。
- `scikit-learn`: 用于数据集的划分。
